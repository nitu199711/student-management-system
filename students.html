<!DOCTYPE html>
<html>
<head>
<title>Students | Student Management System</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="css/style.css">
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { display: flex; height: 100vh; overflow: hidden; font-family: 'Inter', sans-serif; background-color: #f5f5f5; }
    .sidebar { width:284px; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; padding:30px 0; position:fixed; height:100vh; overflow-y:auto; box-shadow:2px 0 10px rgba(0,0,0,0.08); }
    .sidebar .navbar-brand { padding:0 25px 30px; display:block; border-bottom:1px solid rgba(255,255,255,0.15); margin-bottom:22px; font-size:0.98rem; font-weight:600; white-space:nowrap; }
    .sidebar a { color:rgba(255,255,255,0.9); text-decoration:none; padding:12px 22px; display:flex; align-items:center; gap:12px; transition:all 0.25s ease; margin:6px 12px; border-radius:8px; font-size:0.95rem; }
    .sidebar a:hover { background-color:rgba(255,255,255,0.12); padding-left:28px; }
    .sidebar a.active { background-color:rgba(255,255,255,0.18); color:white; font-weight:700; }
    .main-content { margin-left:284px; width:calc(100% - 284px); display:flex; flex-direction:column; height:100vh; }
    .top-nav { background-color:white; border-bottom:1px solid #e8e8e8; padding:20px 35px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 1px 3px rgba(0,0,0,0.05); }
    .top-nav h4 { color:#333; font-weight:600; font-size:1.2rem; margin: 0; }
    .content { flex: 1; overflow-y:auto; padding:36px; background-color:#fafafa; }
    .page-header { display:flex; justify-content:space-between; align-items:center; gap:16px; margin-bottom:18px; }
    .card-table { border-radius:10px; box-shadow:0 1px 6px rgba(0,0,0,0.06); border:1px solid #f0f0f0; overflow:hidden; background:white; }
    .table thead th { border-bottom:1px solid #f1f1f1; }
    .btn-sm { padding:.35rem .6rem; font-size:.82rem; }
</style>
</head>

<body>
<!-- Left Sidebar -->
<div class="sidebar" role="navigation" aria-label="Main sidebar">
    <div class="navbar-brand">
        <i class="fas fa-graduation-cap me-2"></i>
        <span style="vertical-align:middle">Student Management System</span>
    </div>

    <a href="dashboard.html">
        <i class="fas fa-home"></i> Dashboard
    </a>
    <a href="students.html" class="active">
        <i class="fas fa-users"></i> Students
    </a>
    <a href="courses.html">
        <i class="fas fa-book"></i> Courses
    </a>
    <a href="index.html" style="margin-top: auto;">
        <i class="fas fa-sign-out-alt"></i> Logout
    </a>
</div>

<!-- Main Content -->
<div class="main-content">
    <div class="top-nav">
        <h4>Students</h4>
        <span>Welcome back!</span>
    </div>

    <div class="content">
        <div class="page-header">
            <h4 class="mb-0">Student List</h4>
            <a href="add-student.html" class="btn btn-primary btn-sm">Add Student</a>
        </div>

        <div class="card card-table">
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>Student Name</th>
                            <th>Email</th>
                            <th>Age</th>
                            <th>Course</th>
                            <th class="text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="studentsTbody"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
const STUD_KEY = 'students';
const COURSE_KEY = 'courses';

function escapeHtml(str){ return String(str || '').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'",'&#39;'); }

function ensureInitialData(){
  // courses
  if(!localStorage.getItem(COURSE_KEY)){
    const initialCourses = ["BCA","MCA","BSc","BA","BCom","BTech","MTech","MBA","B.Ed","Diploma"];
    localStorage.setItem(COURSE_KEY, JSON.stringify(initialCourses.map((n,i)=>({ id: Date.now()+i, name:n }))));
  }
  // students
  if(!localStorage.getItem(STUD_KEY)){
    const c = JSON.parse(localStorage.getItem(COURSE_KEY));
    const courseNames = c.map(x=>x.name);
    const sampleNames = ["Aditi Singh","Rohit Kumar","Neha Sharma","Ankit Verma","Priya Patel","Vikram Rao","Sara Khan","Kunal Mehta","Rina Das","Manish Joshi"];
    const students = sampleNames.map((name,i)=>({
      id: Date.now() + 100 + i,
      name,
      email: name.toLowerCase().replace(/\s+/g,'') + '@mail.com',
      age: 18 + (i % 6),
      course: courseNames[i % courseNames.length]
    }));
    localStorage.setItem(STUD_KEY, JSON.stringify(students));
  }
}

function renderStudents(){
  const students = JSON.parse(localStorage.getItem(STUD_KEY) || '[]');
  const tbody = document.getElementById('studentsTbody');
  if(students.length === 0){
    tbody.innerHTML = '<tr><td colspan="5" class="text-center text-muted">No students found. Add a student.</td></tr>';
    return;
  }
  tbody.innerHTML = students.map(s => `
    <tr>
      <td>${escapeHtml(s.name)}</td>
      <td>${escapeHtml(s.email)}</td>
      <td>${escapeHtml(String(s.age))}</td>
      <td>${escapeHtml(s.course)}</td>
      <td class="text-center">
        <a href="edit-student.html?id=${s.id}" class="btn btn-outline-primary btn-sm me-1">Edit</a>
        <button class="btn btn-outline-danger btn-sm" onclick="deleteStudent(${s.id})">Delete</button>
      </td>
    </tr>
  `).join('');
}

function deleteStudent(id){
  if(!confirm('Are you sure you want to delete this student?')) return;
  const students = JSON.parse(localStorage.getItem(STUD_KEY) || '[]');
  const filtered = students.filter(s => s.id !== id);
  localStorage.setItem(STUD_KEY, JSON.stringify(filtered));
  // notify other pages
  localStorage.setItem('sm_update', Date.now());
  renderStudents();
}

document.addEventListener('DOMContentLoaded', function(){
  ensureInitialData();
  renderStudents();
});
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
<title>Courses | Student Management System</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="css/style.css">
<style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { display:flex; height:100vh; overflow:hidden; font-family:'Inter',sans-serif; background-color:#f5f5f5; }
    .sidebar { width:284px; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; padding:30px 0; position:fixed; height:100vh; overflow-y:auto; box-shadow:2px 0 10px rgba(0,0,0,0.08); }
    .sidebar .navbar-brand { padding:0 25px 30px; display:block; border-bottom:1px solid rgba(255,255,255,0.15); margin-bottom:22px; font-size:0.98rem; font-weight:600; white-space:nowrap; }
    .sidebar a { color:rgba(255,255,255,0.9); text-decoration:none; padding:12px 22px; display:flex; align-items:center; gap:12px; transition:all 0.25s ease; margin:6px 12px; border-radius:8px; font-size:0.95rem; }
    .sidebar a:hover { background-color:rgba(255,255,255,0.12); padding-left:28px; }
    .sidebar a.active { background-color:rgba(255,255,255,0.18); color:white; font-weight:700; }
    .main-content { margin-left:284px; width:calc(100% - 284px); display:flex; flex-direction:column; height:100vh; }
    .top-nav { background-color:white; border-bottom:1px solid #e8e8e8; padding:20px 35px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 1px 3px rgba(0,0,0,0.05); }
    .top-nav h4{ color:#333; font-weight:600; font-size:1.2rem; margin:0; }
    .top-nav span{ color:#888; font-size:0.95rem; }
    .content { flex:1; overflow-y:auto; padding:36px; background-color:#fafafa; }
    .page-header { display:flex; justify-content:space-between; align-items:center; gap:16px; margin-bottom:18px; }
    .card-table { border-radius:10px; box-shadow:0 1px 6px rgba(0,0,0,0.06); border:1px solid #f0f0f0; overflow:hidden; background:white; }
    .table thead th { border-bottom:1px solid #f1f1f1; }
    .btn-sm { padding:.35rem .6rem; font-size:.82rem; }
</style>
</head>
<body>
<!-- Sidebar -->
<div class="sidebar" role="navigation" aria-label="Main sidebar">
    <div class="navbar-brand">
        <i class="fas fa-graduation-cap me-2"></i> Student Management System
    </div>

    <a href="dashboard.html"><i class="fas fa-home"></i> Dashboard</a>
    <a href="students.html"><i class="fas fa-users"></i> Students</a>
    <a href="courses.html" class="active"><i class="fas fa-book"></i> Courses</a>
    <a href="index.html" style="margin-top:auto;"><i class="fas fa-sign-out-alt"></i> Logout</a>
</div>

<!-- Main -->
<div class="main-content">
    <div class="top-nav">
        <h4>Courses</h4>
        <span>Manage courses</span>
    </div>

    <div class="content">
        <div class="page-header">
            <h4 class="mb-0">Course Management</h4>
            <div>
                <button class="btn btn-outline-secondary btn-sm me-2" id="resetCoursesBtn">Reset</button>
                <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addCourseModal">
                    <i class="fas fa-plus me-1"></i> Add Course
                </button>
            </div>
        </div>

        <div class="card card-table">
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>Course Name</th>
                            <th class="text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="coursesTbody">
                        <!-- rendered by JS -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Add Course Modal -->
<div class="modal fade" id="addCourseModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title">Add Course</h6>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="addCourseForm">
        <div class="modal-body">
          <div class="mb-2">
            <label class="form-label">Course Name</label>
            <input id="courseName" type="text" class="form-control" required>
          </div>
          <div class="alert alert-danger d-none" id="courseError"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary btn-sm">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
const STORAGE_KEY = 'courses';
const STUD_KEY = 'students';

function escapeHtml(str){ return String(str || '').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'",'&#39;'); }

function ensureInitialData(){
  if(!localStorage.getItem(STORAGE_KEY)){
    const initialCourses = ["BCA","MCA","BSc","BA","BCom","BTech","MTech","MBA","B.Ed","Diploma"];
    localStorage.setItem(STORAGE_KEY, JSON.stringify(initialCourses.map((n,i)=>({ id: Date.now()+i, name:n }))));
  }
  if(!localStorage.getItem(STUD_KEY)){
    // create students if missing (simple set) â€” keep consistent with students page
    const c = JSON.parse(localStorage.getItem(STORAGE_KEY));
    const courseNames = c.map(x=>x.name);
    const sampleNames = ["Aditi Singh","Rohit Kumar","Neha Sharma","Ankit Verma","Priya Patel","Vikram Rao","Sara Khan","Kunal Mehta","Rina Das","Manish Joshi"];
    const students = sampleNames.map((name,i)=>({
      id: Date.now() + 100 + i,
      name,
      email: name.toLowerCase().replace(/\s+/g,'') + '@mail.com',
      age: 18 + (i % 6),
      course: courseNames[i % courseNames.length]
    }));
    localStorage.setItem(STUD_KEY, JSON.stringify(students));
  }
}

function renderCourses(){
  const courses = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
  const tbody = document.getElementById('coursesTbody');
  if(courses.length === 0){
    tbody.innerHTML = '<tr><td colspan="2" class="text-center text-muted">No courses found. Add a course.</td></tr>'; return;
  }
  tbody.innerHTML = courses.map(c => `
    <tr>
      <td>${escapeHtml(c.name)}</td>
      <td class="text-center"><button class="btn btn-outline-danger btn-sm" onclick="deleteCourse(${c.id})"><i class="fas fa-trash-alt"></i></button></td>
    </tr>
  `).join('');
}

function addCourse(name){
  const trimmed = (name||'').trim(); if(!trimmed) return { ok:false, msg:'Course required' };
  const courses = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
  if(courses.some(x=>x.name.toLowerCase()===trimmed.toLowerCase())) return { ok:false, msg:'Course exists' };
  courses.push({ id: Date.now(), name: trimmed });
  localStorage.setItem(STORAGE_KEY, JSON.stringify(courses));
  localStorage.setItem('sm_update', Date.now());
  renderCourses();
  return { ok:true };
}

function deleteCourse(id){
  if(!confirm('Delete this course?')) return;
  const courses = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
  const filtered = courses.filter(c=>c.id !== id);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(filtered));
  localStorage.setItem('sm_update', Date.now());
  renderCourses();
}

document.addEventListener('DOMContentLoaded', function(){
  ensureInitialData();
  renderCourses();
  // form
  document.getElementById('addCourseForm').addEventListener('submit', function(e){
    e.preventDefault();
    const input = document.getElementById('courseName');
    const err = document.getElementById('courseError');
    err.classList.add('d-none');
    const res = addCourse(input.value);
    if(!res.ok){ err.textContent = res.msg; err.classList.remove('d-none'); return; }
    input.value = '';
    const modalEl = document.getElementById('addCourseModal');
    const modal = bootstrap.Modal.getInstance(modalEl) || new bootstrap.Modal(modalEl);
    modal.hide();
  });
  document.getElementById('resetCoursesBtn').addEventListener('click', function(){
    if(!confirm('Clear all courses?')) return;
    localStorage.removeItem(STORAGE_KEY);
    localStorage.setItem('sm_update', Date.now());
    renderCourses();
  });
});
</script>
</body>
</html>
